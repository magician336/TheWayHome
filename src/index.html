<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>国产独立游戏数据可视化分析</title>
  
  <script src="https://d3js.org/d3.v7.min.js"></script>
  
  <script src="https://unpkg.com/d3-weighted-voronoi"></script>
  <script src="https://unpkg.com/d3-voronoi-map"></script>
  <script src="https://unpkg.com/d3-voronoi-treemap"></script>

  <link rel="stylesheet" href="theme.css">
  <link rel="stylesheet" href="styles.css">
  <script src="config.js"></script>
</head>
<body class="parallel-chart-body">

  <h2>国产独立游戏数据可视化分析</h2>

  <div id="parallel-chart-dashboard">
    <div id="parallel-chart-main-wrapper" class="parallel-chart-box">
      <div class="parallel-chart-header">
        <span class="parallel-chart-title">平行坐标系</span>
        <div style="display: flex; gap: 10px; align-items: center;">
          <select id="parallel-chart-colorSelect" class="parallel-chart-select">
            <option value="year" selected>年份</option>
            <option value="original_price">售价</option>
            <option value="discount_strength">折扣力度</option>
            <option value="favorable_rate">好评率</option>
            <option value="log_players">游玩人数</option>
            <option value="retention_days">留存期</option>
          </select>
          <button id="parallel-chart-exitFocusBtn" onclick="parallelChart_exitFocusMode()" style="display: none; padding: 4px 12px; font-size: 12px;">退出观察模式</button>
        </div>
      </div>
      <div class="parallel-chart-controls">
        <div class="parallel-chart-input-group">
          <label>🔍 搜索:</label>
          <input type="text" id="parallel-chart-searchName" class="parallel-chart-input" placeholder="输入名称 (如: 悟空)">
        </div>
        <div class="parallel-chart-input-group">
          <label>📅 年份:</label>
          <select id="parallel-chart-selectYear" class="parallel-chart-select"><option value="">全部</option></select>
        </div>
        <button onclick="parallelChart_resetFilters()" class="parallel-chart-btn">重置</button>
      </div>
      <div id="parallel-chart-correlation-bar" style="height: 60px; margin-bottom: 10px; display: none;"></div>
      <div id="parallel-chart-main-container" class="parallel-chart-viz-box"></div>
    </div>

    <div id="parallel-chart-bottom-wrapper">
      
      <div id="parallel-chart-tags-wrapper" class="parallel-chart-box">
        <div class="parallel-chart-header"><span class="parallel-chart-title">Tags 类别与热度</span></div>
        <div id="parallel-chart-tag-viz" class="parallel-chart-viz-box"></div>
      </div>

      <div class="parallel-chart-box" style="width: 45%; height: 500px; flex-shrink: 0;">
        <div class="parallel-chart-header">
          <span class="parallel-chart-title">游戏分布与策略分析</span>
          
          <div style="display:flex; align-items: center;">
            <div id="parallel-chart-scatter-controls" style="display:flex; gap:5px; align-items: center; transition: opacity 0.3s; margin-right: 15px;">
              <span style="font-size:12px; color:#888;">X:</span>
              <select id="parallel-chart-scatterX" class="parallel-chart-select">
                <option value="year" selected>年份</option>
                <option value="original_price">售价</option>
                <option value="discount_strength">折扣</option>
              </select>
              <span style="font-size:12px; color:#888;">Y:</span>
              <select id="parallel-chart-scatterY" class="parallel-chart-select">
                <option value="log_players" selected>在线</option>
                <option value="favorable_rate">好评率</option>
                <option value="retention_days">留存</option>
              </select>
            </div>

            <button id="parallel-chart-toggleViewBtn" onclick="parallelChart_toggleScatterMode()" style="font-size: 12px; padding: 4px 12px; background: var(--accent-color); border: none; color: white; border-radius: 4px; cursor: pointer; transition: background 0.3s;">
              切换至折扣策略视图 ➡
            </button>
          </div>
        </div>
        
        <div id="parallel-chart-scatter-viz" class="parallel-chart-viz-box"></div>
      </div>
      
    </div>
  </div>

  <div id="parallel-chart-shared-tooltip" class="parallel-chart-tooltip"></div>

  <script src="modules/dataManager.js"></script>
  <script src="modules/utils.js"></script>
  <script src="modules/parallelCoordinates.js"></script>
  <script src="modules/tagsDistribution.js"></script>
  
  <script src="modules/scatterPlot.js"></script>
  
  <script src="parallelChartMain.js"></script>
</body>
</html>